{"version":3,"sources":["webpack:///webpack/bootstrap 438c03d484a46077b362","webpack:///./js/disk_sampling_demo.js","webpack:///./js/poisson_disc_generator.js"],"names":["document","addEventListener","img","Image","src","imageCanv","getElementById","imgContext","getContext","onload","drawImage","poissonCanvas","poissonCanvasMap","generatePoissonSample","imageCanvas","canvas","canvas2","radius","maxCandidates","canvasHeight","height","canvasWidth","width","context","context2","imageCanvasContext","cellSize","Math","floor","sqrt","gridHeight","ceil","gridWidth","grid","points","firstPointsArr","rowIdx","colIdx","Array","pointToGridCoords","point","calculateDotRadius","pixelData","getImageData","data","slice","grayScaleVal","reduce","memo","val","dotRadius","insert","push","beginPath","arc","PI","fill","drawLine","newPoint","prevPoint","moveTo","lineTo","stroke","distance","pointA","pointB","squaredDist","pow","isInRange","isValidPoint","rowIdxMin","max","colIdxMin","rowIdxMax","min","colIdxMax","p0","round","random","refIdx","refPoint","numCandidates","candidateMaxReached","candidatePoint","theta","dist","drawNextPoint","activePoints","length","cos","sin","newPoints","setTimeout","concat"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 438c03d484a46077b362","import generatePoissonSample from './poisson_disc_generator';\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  // const img = document.getElementById('original-image');\n  // var imageCanv = document.getElementById('image-canvas');\n  // imageCanv.width = img.width;\n  // imageCanv.height = img.height;\n  // const imgContext = imageCanv.getContext('2d');\n  const img = new Image();\n  img.src = 'starry_night.jpg';\n  // img.crossOrigin = 'anonymous';\n  var imageCanv = document.getElementById('image-canvas');\n  const imgContext = imageCanv.getContext('2d');\n  img.onload = () => {\n    imgContext.drawImage(img, 0, 0, 400, 400);\n  };\n  // document.append(canvas);\n  // context.getImageData(x, y, 1, 1).data;\n  const poissonCanvas = document.getElementById(\"poisson-canvas\");\n  const poissonCanvasMap = document.getElementById(\"poisson-path-canvas\");\n\n  generatePoissonSample(imageCanv, poissonCanvas, poissonCanvasMap, 2, 30);\n});\n\n\n\n// WEBPACK FOOTER //\n// ./js/disk_sampling_demo.js","export default function generatePoissonSample(imageCanvas, canvas, canvas2, radius, maxCandidates) {\n  const canvasHeight = canvas.height;\n  const canvasWidth = canvas.width;\n  const context = canvas.getContext(\"2d\");\n  const context2 = canvas2.getContext(\"2d\");\n  const imageCanvasContext = imageCanvas.getContext(\"2d\");\n  const cellSize = Math.floor(radius / Math.sqrt(2));\n  const gridHeight = Math.ceil(canvasHeight / cellSize) + 1;\n  const gridWidth = Math.ceil(canvasWidth / cellSize) + 1;\n\n  const grid = [];\n  const points = [];\n  const firstPointsArr = [];\n\n  let rowIdx;\n  let colIdx;\n  for (rowIdx = 0; rowIdx < gridHeight; rowIdx++) {\n    grid[rowIdx] = new Array(gridWidth);\n  }\n\n  function pointToGridCoords(point) {\n    rowIdx = Math.floor(point[0] / cellSize);\n    colIdx = Math.floor(point[1] / cellSize);\n    return [rowIdx, colIdx];\n  }\n\n  function calculateDotRadius(point) {\n    const pixelData = imageCanvasContext.getImageData(point[0], point[1], 1, 1).data.slice(0, 3);\n    const grayScaleVal = pixelData.reduce((memo, val) => memo + val, 0) / 3;\n    const dotRadius = ((300 - grayScaleVal) / 300) * (radius / 2);\n    // debugger\n    return dotRadius;\n  }\n\n  function insert(point) {\n    points.push(point);\n    const dotRadius = calculateDotRadius(point);\n    // debugger\n    context.beginPath();\n    context.arc(point[0], point[1], dotRadius, 0, 2*Math.PI);\n    context.fill();\n    [rowIdx, colIdx] = pointToGridCoords(point);\n    grid[rowIdx][colIdx] = point;\n  }\n\n  function drawLine(newPoint, prevPoint) {\n    context2.beginPath();\n    context2.moveTo(prevPoint[0], prevPoint[1]);\n    context2.lineTo(newPoint[0],newPoint[1]);\n    context2.stroke();\n  }\n\n  function distance(pointA, pointB) {\n    const squaredDist = Math.pow((pointA[0] - pointB[0]), 2) + Math.pow((pointA[1] - pointB[1]), 2)\n    return Math.sqrt(squaredDist);\n  }\n\n  function isInRange(point) {\n    return (point[0] > 0 &&\n            point[0] < canvasHeight &&\n            point[1] > 0 &&\n            point[1] < canvasWidth);\n  }\n\n  function isValidPoint(point) {\n    if (!isInRange(point)) { return false; }\n    [rowIdx, colIdx] = pointToGridCoords(point);\n    const rowIdxMin = Math.max(0, rowIdx - 1);\n    const colIdxMin = Math.max(0, colIdx - 1);\n    const rowIdxMax = Math.min(gridWidth - 1, rowIdx + 1);\n    const colIdxMax = Math.min(gridHeight - 1, colIdx + 1);\n\n    for (rowIdx = rowIdxMin; rowIdx <= rowIdxMax; rowIdx++) {\n      for (colIdx = colIdxMin; colIdx <= colIdxMax; colIdx++) {\n        if (grid[rowIdx][colIdx] && distance(grid[rowIdx][colIdx], point) < radius) {\n               return false;\n             }\n      }\n    }\n    return true;\n  }\n\n  const p0 = [Math.round(Math.random() * canvasWidth), Math.round(Math.random() * canvasHeight)];\n  firstPointsArr.push(p0);\n  insert(p0);\n\n  let refIdx;\n  let refPoint;\n  let numCandidates;\n  let candidateMaxReached;\n  let candidatePoint;\n  let theta;\n  let dist;\n\n  function drawNextPoint(activePoints) {\n    if (activePoints.length === 0) { return; }\n    refIdx = Math.floor(Math.random() * activePoints.length);\n    refPoint = activePoints[refIdx];\n    candidateMaxReached = true;\n    for (numCandidates = 0; numCandidates <= maxCandidates; numCandidates++) {\n      theta = Math.random() * 360;\n      dist = (Math.random()*radius + radius);\n      candidatePoint = [dist * Math.cos(theta) + refPoint[0],\n                        dist * Math.sin(theta) + refPoint[1]];\n      if (isValidPoint(candidatePoint)) {\n        insert(candidatePoint);\n        drawLine(candidatePoint, refPoint);\n        activePoints.push(candidatePoint);\n        candidateMaxReached = false;\n        break;\n      }\n    }\n    let newPoints;\n    setTimeout( () => {\n      if (candidateMaxReached) {\n        newPoints = activePoints.slice(0, refIdx).concat(activePoints.slice(refIdx + 1));\n      } else {\n        newPoints = activePoints.slice(0);\n      }\n      drawNextPoint(newPoints);\n    }, 0)\n  }\n  //\n  drawNextPoint(firstPointsArr);\n  // while (activePoints.length > 0) {\n  //   refIdx = Math.floor(Math.random() * activePoints.length);\n  //   refPoint = activePoints[refIdx];\n  //   candidateMaxReached = true;\n  //   for (numCandidates = 0; numCandidates <= maxCandidates; numCandidates++) {\n  //     theta = Math.random() * 360;\n  //     dist = (Math.random()*radius + radius);\n  //     candidatePoint = [dist * Math.cos(theta) + refPoint[0],\n  //                       dist * Math.sin(theta) + refPoint[1]];\n  //     if (isValidPoint(candidatePoint)) {\n  //       insert(candidatePoint);\n  //       drawLine(candidatePoint, refPoint);\n  //       activePoints.push(candidatePoint);\n  //       candidateMaxReached = false;\n  //       break;\n  //     }\n  //   }\n  //   if (candidateMaxReached) {\n  //     activePoints.splice(refIdx, 1);\n  //   }\n  // }\n\n  // return grid;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./js/poisson_disc_generator.js"],"sourceRoot":""}